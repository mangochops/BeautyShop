"use strict";exports.id=2671,exports.ids=[2671],exports.modules={82671:(e,r,i)=>{i.r(r),i.d(r,{getCategories:()=>l,getFeaturedProducts:()=>d,getProductById:()=>g,getProducts:()=>s,getRelatedProducts:()=>u});var t={};i.r(t);var n=i(96330),o=i(70290),a=i(93714);let c=global;if(process.env.VERCEL){let e=new o.bC({connectionString:process.env.DATABASE_URL}),r=new a.J(e);new n.PrismaClient({adapter:r,log:["error"]})}else c.prisma||new n.PrismaClient({log:["error"]});async function s(){try{let e=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{inStock:!0}});if(!Array.isArray(e))return console.error("getProducts: Expected array, got:",e),[];return e.map(e=>({id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:e.originalPrice??void 0,image:e.images[0]?.url??void 0,category:e.category?.slug??"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}))}catch(e){return console.error("Error in getProducts:",e),[]}}async function d(){try{let e=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{featured:!0,inStock:!0}});if(!Array.isArray(e))return console.error("getFeaturedProducts: Expected array, got:",e),[];return e.map(e=>({id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:e.originalPrice??void 0,image:e.images?.[0]?.url??void 0,category:e.category?.slug??"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}))}catch(e){return console.error("Error in getFeaturedProducts:",e),[]}}async function g(e){if(!e)return console.warn("getProductById: No ID provided"),null;try{let r=await t.prisma.product.findUnique({where:{id:e},include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}}});if(!r)return console.warn(`getProductById: Product not found for id ${e}`),null;return{id:r.id,name:r.name,description:r.description,price:r.price,originalPrice:r.originalPrice??void 0,image:r.images?.[0]?.url??void 0,category:r.category?.slug??"",featured:r.featured,rating:r.reviews.length?r.reviews.reduce((e,r)=>e+r.rating,0)/r.reviews.length:0,reviews:r.reviews.length,inStock:r.inStock}}catch(r){return console.error(`Error in getProductById for id ${e}:`,r),null}}async function u(e){if(!e)return console.warn("getRelatedProducts: No category provided"),[];try{let r=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{category:{slug:e},inStock:!0},take:4});if(!Array.isArray(r))return console.error("getRelatedProducts: Expected array, got:",r),[];return r.map(e=>({id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:e.originalPrice??void 0,image:e.images?.[0]?.url??void 0,category:e.category?.slug??"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}))}catch(r){return console.error(`Error in getRelatedProducts for category ${e}:`,r),[]}}async function l(){try{let e=await t.prisma.category.findMany({include:{_count:{select:{products:!0}}}});if(!Array.isArray(e))return console.error("getCategories: Expected array, got:",e),[];return e.map(e=>({id:e.id,name:e.name,slug:e.slug,image:e.image??void 0,productCount:e._count.products}))}catch(e){return console.error("Error in getCategories:",e),[]}}}};