"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1178],{51178:(e,r,i)=>{i.r(r),i.d(r,{getCategories:()=>v,getFeaturedProducts:()=>u,getProductById:()=>s,getProducts:()=>l,getRelatedProducts:()=>g});var t={};i.r(t);var n=i(11094),o=i(73668),a=i(82441),c=i(2818);let d=i.g;if(c.env.VERCEL){let e=new o.bC({connectionString:c.env.DATABASE_URL}),r=new a.J(e);new n.PrismaClient({adapter:r,log:["error"]})}else d.prisma||new n.PrismaClient({log:["error"]});async function l(){try{let e=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{inStock:!0}});if(!Array.isArray(e))return console.error("getProducts: Expected array, got:",e),[];return e.map(e=>{var r,i,t,n,o;return{id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:null!==(t=e.originalPrice)&&void 0!==t?t:void 0,image:null!==(n=null===(r=e.images[0])||void 0===r?void 0:r.url)&&void 0!==n?n:void 0,category:null!==(o=null===(i=e.category)||void 0===i?void 0:i.slug)&&void 0!==o?o:"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}})}catch(e){return console.error("Error in getProducts:",e),[]}}async function u(){try{let e=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{featured:!0,inStock:!0}});if(!Array.isArray(e))return console.error("getFeaturedProducts: Expected array, got:",e),[];return e.map(e=>{var r,i,t,n,o,a;return{id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:null!==(n=e.originalPrice)&&void 0!==n?n:void 0,image:null!==(o=null===(i=e.images)||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:r.url)&&void 0!==o?o:void 0,category:null!==(a=null===(t=e.category)||void 0===t?void 0:t.slug)&&void 0!==a?a:"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}})}catch(e){return console.error("Error in getFeaturedProducts:",e),[]}}async function s(e){if(!e)return console.warn("getProductById: No ID provided"),null;try{var r,i,n,o,a,c;let d=await t.prisma.product.findUnique({where:{id:e},include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}}});if(!d)return console.warn("getProductById: Product not found for id ".concat(e)),null;return{id:d.id,name:d.name,description:d.description,price:d.price,originalPrice:null!==(o=d.originalPrice)&&void 0!==o?o:void 0,image:null!==(a=null===(i=d.images)||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:r.url)&&void 0!==a?a:void 0,category:null!==(c=null===(n=d.category)||void 0===n?void 0:n.slug)&&void 0!==c?c:"",featured:d.featured,rating:d.reviews.length?d.reviews.reduce((e,r)=>e+r.rating,0)/d.reviews.length:0,reviews:d.reviews.length,inStock:d.inStock}}catch(r){return console.error("Error in getProductById for id ".concat(e,":"),r),null}}async function g(e){if(!e)return console.warn("getRelatedProducts: No category provided"),[];try{let r=await t.prisma.product.findMany({include:{category:!0,images:{where:{isMain:!0},take:1},reviews:{select:{rating:!0}}},where:{category:{slug:e},inStock:!0},take:4});if(!Array.isArray(r))return console.error("getRelatedProducts: Expected array, got:",r),[];return r.map(e=>{var r,i,t,n,o,a;return{id:e.id,name:e.name,description:e.description,price:e.price,originalPrice:null!==(n=e.originalPrice)&&void 0!==n?n:void 0,image:null!==(o=null===(i=e.images)||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:r.url)&&void 0!==o?o:void 0,category:null!==(a=null===(t=e.category)||void 0===t?void 0:t.slug)&&void 0!==a?a:"",featured:e.featured,rating:e.reviews.length?e.reviews.reduce((e,r)=>e+r.rating,0)/e.reviews.length:0,reviews:e.reviews.length,inStock:e.inStock}})}catch(r){return console.error("Error in getRelatedProducts for category ".concat(e,":"),r),[]}}async function v(){try{let e=await t.prisma.category.findMany({include:{_count:{select:{products:!0}}}});if(!Array.isArray(e))return console.error("getCategories: Expected array, got:",e),[];return e.map(e=>{var r;return{id:e.id,name:e.name,slug:e.slug,image:null!==(r=e.image)&&void 0!==r?r:void 0,productCount:e._count.products}})}catch(e){return console.error("Error in getCategories:",e),[]}}}}]);